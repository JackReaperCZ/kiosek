(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[676],{39:function(e,t,r){Promise.resolve().then(r.bind(r,2286))},2286:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return y}});var a=r(3827),i=r(4090),n=r(8876),s=r(9125),o=r(4032),l=r(7856),c=r(3383),d=r(7305),u=r(1907),m=r(5550),h=r(7907),p=r(7142),x=r(656),j=r(5087),f=r(7363),g=r(8200),b=r(5702),v=r(1129),w=r(2310),Z=r(3898);function y(){let e=(0,h.useRouter)(),[t,r]=(0,i.useState)(!0),[y,k]=(0,i.useState)(0),[N,S]=(0,i.useState)("horizontal"),[D,E]=(0,i.useState)({name:"",tags:[],description:"",thumbnail:null,media:[]}),[z,P]=(0,i.useState)([]),[O,_]=(0,i.useState)(!1);(0,i.useEffect)(()=>{(async()=>{let t=localStorage.getItem("token");if(!t){e.push("/login");return}try{if(!(await fetch("".concat(Z.v.apiUrl,"/api/auth/validate"),{method:"GET",headers:{Authorization:"Bearer ".concat(t)}})).ok)throw Error("Invalid token");r(!1)}catch(t){localStorage.removeItem("token"),localStorage.removeItem("name"),e.push("/login")}})()},[e]),(0,i.useEffect)(()=>{let e=()=>{S(window.innerWidth<600?"vertical":"horizontal")};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);let C=["N\xe1zev","Popis","Thumbnail","Media","Uk\xe1zka"],I=async()=>{if(!O)try{_(!0);let t=(0,v.Ow)(D);if(t.length>0){P(t),_(!1);return}let r=localStorage.getItem("token");if(!r){e.push("/login");return}let a=new FormData;a.append("name",D.name),a.append("description",D.description),a.append("tags",JSON.stringify(D.tags)),D.thumbnail&&a.append("thumbnail",D.thumbnail),D.media.forEach((e,t)=>{a.append("media_".concat(t),e)});let i=await fetch("".concat(Z.v.apiUrl,"/api/project"),{method:"POST",headers:{Authorization:"Bearer ".concat(r)},body:a});if(!i.ok){let e=await i.json();throw Error(e.message||"Failed to submit project")}let n=await i.json();console.log("Project submitted successfully:",n),k(e=>e+1),e.push("/my-projects")}catch(e){P([e.message||"Failed to submit project"])}finally{_(!1)}};return t?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-50",children:(0,a.jsx)(n.Z,{size:"lg"})}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(w.Z,{}),(0,a.jsx)("div",{className:"pt-16",children:(0,a.jsx)(s.Z,{maxWidth:!1,disableGutters:!0,className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-50 flex flex-col",children:(0,a.jsx)(s.Z,{maxWidth:"lg",className:"py-8 px-4 flex-grow flex flex-col justify-center",children:(0,a.jsxs)(o.Z,{className:"bg-white/80 backdrop-blur-sm rounded-xl shadow-xl p-4 sm:p-6 md:p-8 mx-auto w-full",sx:{border:"1px solid rgba(255, 255, 255, 0.2)"},children:[(0,a.jsx)(l.Z,{orientation:N,sx:{width:"100%",mb:4,"& .MuiStepButton-root":{cursor:"default"},"@media (max-width: 640px)":{"& .MuiStep-root":{padding:"8px 0"},"& .MuiStepConnector-line":{minHeight:"24px"}}},children:C.map((e,t)=>(0,a.jsx)(c.Z,{indicator:(0,a.jsx)(d.Z,{variant:y<=t?"soft":"solid",color:y<t?"neutral":"primary",children:y<=t?t+1:(0,a.jsx)(p.Z,{})}),sx:[y>t&&t!==C.length-1&&{"&::after":{bgcolor:"primary.solidBg"}}],children:(0,a.jsx)(u.Z,{children:e})},e))}),(0,a.jsx)("div",{className:"mt-8",children:y===C.length?(0,a.jsx)("div",{className:"text-center py-12",children:(0,a.jsx)("h2",{className:"text-2xl md:text-3xl font-bold mb-4 bg-clip-text text-transparent bg-gradient-to-r from-blue-600 to-indigo-600",children:"All steps completed - your project is being submitted"})}):(0,a.jsxs)("div",{children:[(e=>{switch(e){case 0:return(0,a.jsx)(x.Z,{projectData:D,setProjectData:E});case 1:return(0,a.jsx)(j.Z,{projectData:D,setProjectData:E});case 2:return(0,a.jsx)(f.Z,{projectData:D,setProjectData:E});case 3:return(0,a.jsx)(g.Z,{projectData:D,setProjectData:E});case 4:return(0,a.jsx)(b.Z,{projectData:D});default:return"Unknown step"}})(y),(0,a.jsxs)("div",{className:"mt-8 flex justify-between",children:[(0,a.jsx)(m.Z,{variant:"outlined",color:"neutral",disabled:0===y,onClick:()=>{k(e=>e-1)},children:"Zpět"}),(0,a.jsx)("div",{className:"flex gap-2",children:y===C.length-1?(0,a.jsx)(m.Z,{variant:"solid",color:"primary",onClick:I,disabled:O,endDecorator:O&&(0,a.jsx)(n.Z,{size:"sm"}),children:O?"Odes\xedl\xe1n\xed...":"Odeslat"}):(0,a.jsx)(m.Z,{variant:"solid",color:"primary",onClick:()=>{let e=(0,v.sc)(y,D);if(e.length>0){P(e);return}P([]),k(e=>e+1)},children:"Dalš\xed"})})]}),z.length>0&&(0,a.jsx)("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:z.map((e,t)=>(0,a.jsx)("p",{className:"text-red-600",children:e},t))})]})})]})})})})]})}}},function(e){e.O(0,[572,902,879,559,550,353,889,557,189,349,971,69,744],function(){return e(e.s=39)}),_N_E=e.O()}]);